---
title: Advanced Python Pandas (Merging, Apply, Groupby, Pivot, Date) [Introduction to Data Science in Python - 2]
categories: Applied-Data-Science-with-Python Introduction-to-Data-Science-in-Python
header:
  teaser: /assets/teasers/1.jpg
---
# Merging Dataframes


```python
import pandas as pd
import numpy as np

staff_df = pd.DataFrame([{'Name': 'Kelly', 'Role': 'Director of HR'},
                         {'Name': 'Sally', 'Role': 'Course liasion'},
                         {'Name': 'James', 'Role': 'Grader'}])
staff_df = staff_df.set_index('Name')
staff_df.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Kelly</th>
      <td>Director of HR</td>
    </tr>
    <tr>
      <th>Sally</th>
      <td>Course liasion</td>
    </tr>
    <tr>
      <th>James</th>
      <td>Grader</td>
    </tr>
  </tbody>
</table>
</div>




```python
student_df = pd.DataFrame([{'Name': 'James', 'School': 'Business'},
                           {'Name': 'Mike', 'School': 'Law'},
                           {'Name': 'Sally', 'School': 'Engineering'}])
student_df = student_df.set_index('Name')
student_df.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>School</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>James</th>
      <td>Business</td>
    </tr>
    <tr>
      <th>Mike</th>
      <td>Law</td>
    </tr>
    <tr>
      <th>Sally</th>
      <td>Engineering</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.merge(staff_df, student_df, how='outer', left_index=True, right_index=True)
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>School</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>James</th>
      <td>Grader</td>
      <td>Business</td>
    </tr>
    <tr>
      <th>Kelly</th>
      <td>Director of HR</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mike</th>
      <td>NaN</td>
      <td>Law</td>
    </tr>
    <tr>
      <th>Sally</th>
      <td>Course liasion</td>
      <td>Engineering</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.merge(staff_df, student_df, how='inner', left_index=True, right_index=True)
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>School</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Sally</th>
      <td>Course liasion</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>James</th>
      <td>Grader</td>
      <td>Business</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.merge(staff_df, student_df, how='left', left_index=True, right_index=True)
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>School</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Kelly</th>
      <td>Director of HR</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Sally</th>
      <td>Course liasion</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>James</th>
      <td>Grader</td>
      <td>Business</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.merge(staff_df, student_df, how='right', left_index=True, right_index=True)
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Role</th>
      <th>School</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>James</th>
      <td>Grader</td>
      <td>Business</td>
    </tr>
    <tr>
      <th>Mike</th>
      <td>NaN</td>
      <td>Law</td>
    </tr>
    <tr>
      <th>Sally</th>
      <td>Course liasion</td>
      <td>Engineering</td>
    </tr>
  </tbody>
</table>
</div>




```python
staff_df = staff_df.reset_index()
student_df = student_df.reset_index()
pd.merge(staff_df, student_df, how='left', left_on='Name', right_on='Name')
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Role</th>
      <th>School</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kelly</td>
      <td>Director of HR</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sally</td>
      <td>Course liasion</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>2</th>
      <td>James</td>
      <td>Grader</td>
      <td>Business</td>
    </tr>
  </tbody>
</table>
</div>




```python
staff_df = pd.DataFrame([{'Name': 'Kelly', 'Role': 'Director of HR', 'Location': 'State Street'},
                         {'Name': 'Sally', 'Role': 'Course liasion', 'Location': 'Washington Avenue'},
                         {'Name': 'James', 'Role': 'Grader', 'Location': 'Washington Avenue'}])
student_df = pd.DataFrame([{'Name': 'James', 'School': 'Business', 'Location': '1024 Billiard Avenue'},
                           {'Name': 'Mike', 'School': 'Law', 'Location': 'Fraternity House #22'},
                           {'Name': 'Sally', 'School': 'Engineering', 'Location': '512 Wilson Crescent'}])
pd.merge(staff_df, student_df, how='left', left_on='Name', right_on='Name')
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location_x</th>
      <th>Name</th>
      <th>Role</th>
      <th>Location_y</th>
      <th>School</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>State Street</td>
      <td>Kelly</td>
      <td>Director of HR</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Washington Avenue</td>
      <td>Sally</td>
      <td>Course liasion</td>
      <td>512 Wilson Crescent</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Washington Avenue</td>
      <td>James</td>
      <td>Grader</td>
      <td>1024 Billiard Avenue</td>
      <td>Business</td>
    </tr>
  </tbody>
</table>
</div>




```python
staff_df = pd.DataFrame([{'First Name': 'Kelly', 'Last Name': 'Desjardins', 'Role': 'Director of HR'},
                         {'First Name': 'Sally', 'Last Name': 'Brooks', 'Role': 'Course liasion'},
                         {'First Name': 'James', 'Last Name': 'Wilde', 'Role': 'Grader'}])
student_df = pd.DataFrame([{'First Name': 'James', 'Last Name': 'Hammond', 'School': 'Business'},
                           {'First Name': 'Mike', 'Last Name': 'Smith', 'School': 'Law'},
                           {'First Name': 'Sally', 'Last Name': 'Brooks', 'School': 'Engineering'}])
pd.merge(staff_df, student_df, how='inner', left_on=['First Name','Last Name'], right_on=['First Name','Last Name'])
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Role</th>
      <th>School</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Sally</td>
      <td>Brooks</td>
      <td>Course liasion</td>
      <td>Engineering</td>
    </tr>
  </tbody>
</table>
</div>



# 'Apply'


```python
df = pd.read_csv('census.csv')
df.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SUMLEV</th>
      <th>REGION</th>
      <th>DIVISION</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>STNAME</th>
      <th>CTYNAME</th>
      <th>CENSUS2010POP</th>
      <th>ESTIMATESBASE2010</th>
      <th>POPESTIMATE2010</th>
      <th>...</th>
      <th>RDOMESTICMIG2011</th>
      <th>RDOMESTICMIG2012</th>
      <th>RDOMESTICMIG2013</th>
      <th>RDOMESTICMIG2014</th>
      <th>RDOMESTICMIG2015</th>
      <th>RNETMIG2011</th>
      <th>RNETMIG2012</th>
      <th>RNETMIG2013</th>
      <th>RNETMIG2014</th>
      <th>RNETMIG2015</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>40</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>Alabama</td>
      <td>Alabama</td>
      <td>4779736</td>
      <td>4780127</td>
      <td>4785161</td>
      <td>...</td>
      <td>0.002295</td>
      <td>-0.193196</td>
      <td>0.381066</td>
      <td>0.582002</td>
      <td>-0.467369</td>
      <td>1.030015</td>
      <td>0.826644</td>
      <td>1.383282</td>
      <td>1.724718</td>
      <td>0.712594</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>54571</td>
      <td>54571</td>
      <td>54660</td>
      <td>...</td>
      <td>7.242091</td>
      <td>-2.915927</td>
      <td>-3.012349</td>
      <td>2.265971</td>
      <td>-2.530799</td>
      <td>7.606016</td>
      <td>-2.626146</td>
      <td>-2.722002</td>
      <td>2.592270</td>
      <td>-2.187333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>Alabama</td>
      <td>Baldwin County</td>
      <td>182265</td>
      <td>182265</td>
      <td>183193</td>
      <td>...</td>
      <td>14.832960</td>
      <td>17.647293</td>
      <td>21.845705</td>
      <td>19.243287</td>
      <td>17.197872</td>
      <td>15.844176</td>
      <td>18.559627</td>
      <td>22.727626</td>
      <td>20.317142</td>
      <td>18.293499</td>
    </tr>
    <tr>
      <th>3</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>Alabama</td>
      <td>Barbour County</td>
      <td>27457</td>
      <td>27457</td>
      <td>27341</td>
      <td>...</td>
      <td>-4.728132</td>
      <td>-2.500690</td>
      <td>-7.056824</td>
      <td>-3.904217</td>
      <td>-10.543299</td>
      <td>-4.874741</td>
      <td>-2.758113</td>
      <td>-7.167664</td>
      <td>-3.978583</td>
      <td>-10.543299</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>7</td>
      <td>Alabama</td>
      <td>Bibb County</td>
      <td>22915</td>
      <td>22919</td>
      <td>22861</td>
      <td>...</td>
      <td>-5.527043</td>
      <td>-5.068871</td>
      <td>-6.201001</td>
      <td>-0.177537</td>
      <td>0.177258</td>
      <td>-5.088389</td>
      <td>-4.363636</td>
      <td>-5.403729</td>
      <td>0.754533</td>
      <td>1.107861</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>




```python
df = df[df['SUMLEV']==50]
df.set_index(['STNAME','CTYNAME'], inplace=True)
df.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>SUMLEV</th>
      <th>REGION</th>
      <th>DIVISION</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>CENSUS2010POP</th>
      <th>ESTIMATESBASE2010</th>
      <th>POPESTIMATE2010</th>
      <th>POPESTIMATE2011</th>
      <th>POPESTIMATE2012</th>
      <th>...</th>
      <th>RDOMESTICMIG2011</th>
      <th>RDOMESTICMIG2012</th>
      <th>RDOMESTICMIG2013</th>
      <th>RDOMESTICMIG2014</th>
      <th>RDOMESTICMIG2015</th>
      <th>RNETMIG2011</th>
      <th>RNETMIG2012</th>
      <th>RNETMIG2013</th>
      <th>RNETMIG2014</th>
      <th>RNETMIG2015</th>
    </tr>
    <tr>
      <th>STNAME</th>
      <th>CTYNAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Alabama</th>
      <th>Autauga County</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>54571</td>
      <td>54571</td>
      <td>54660</td>
      <td>55253</td>
      <td>55175</td>
      <td>...</td>
      <td>7.242091</td>
      <td>-2.915927</td>
      <td>-3.012349</td>
      <td>2.265971</td>
      <td>-2.530799</td>
      <td>7.606016</td>
      <td>-2.626146</td>
      <td>-2.722002</td>
      <td>2.592270</td>
      <td>-2.187333</td>
    </tr>
    <tr>
      <th>Baldwin County</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>182265</td>
      <td>182265</td>
      <td>183193</td>
      <td>186659</td>
      <td>190396</td>
      <td>...</td>
      <td>14.832960</td>
      <td>17.647293</td>
      <td>21.845705</td>
      <td>19.243287</td>
      <td>17.197872</td>
      <td>15.844176</td>
      <td>18.559627</td>
      <td>22.727626</td>
      <td>20.317142</td>
      <td>18.293499</td>
    </tr>
    <tr>
      <th>Barbour County</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>27457</td>
      <td>27457</td>
      <td>27341</td>
      <td>27226</td>
      <td>27159</td>
      <td>...</td>
      <td>-4.728132</td>
      <td>-2.500690</td>
      <td>-7.056824</td>
      <td>-3.904217</td>
      <td>-10.543299</td>
      <td>-4.874741</td>
      <td>-2.758113</td>
      <td>-7.167664</td>
      <td>-3.978583</td>
      <td>-10.543299</td>
    </tr>
    <tr>
      <th>Bibb County</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>7</td>
      <td>22915</td>
      <td>22919</td>
      <td>22861</td>
      <td>22733</td>
      <td>22642</td>
      <td>...</td>
      <td>-5.527043</td>
      <td>-5.068871</td>
      <td>-6.201001</td>
      <td>-0.177537</td>
      <td>0.177258</td>
      <td>-5.088389</td>
      <td>-4.363636</td>
      <td>-5.403729</td>
      <td>0.754533</td>
      <td>1.107861</td>
    </tr>
    <tr>
      <th>Blount County</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>9</td>
      <td>57322</td>
      <td>57322</td>
      <td>57373</td>
      <td>57711</td>
      <td>57776</td>
      <td>...</td>
      <td>1.807375</td>
      <td>-1.177622</td>
      <td>-1.748766</td>
      <td>-2.062535</td>
      <td>-1.369970</td>
      <td>1.859511</td>
      <td>-0.848580</td>
      <td>-1.402476</td>
      <td>-1.577232</td>
      <td>-0.884411</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 98 columns</p>
</div>




```python
# find min and max of following values for each index.

rows = ['POPESTIMATE2010',
        'POPESTIMATE2011',
        'POPESTIMATE2012',
        'POPESTIMATE2013',
        'POPESTIMATE2014',
        'POPESTIMATE2015']
result = df.apply(lambda x: pd.Series({'min': x[rows].min(), 'max': x[rows].max()}), axis=1)
result.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>STNAME</th>
      <th>CTYNAME</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Alabama</th>
      <th>Autauga County</th>
      <td>54660.0</td>
      <td>55347.0</td>
    </tr>
    <tr>
      <th>Baldwin County</th>
      <td>183193.0</td>
      <td>203709.0</td>
    </tr>
    <tr>
      <th>Barbour County</th>
      <td>26489.0</td>
      <td>27341.0</td>
    </tr>
    <tr>
      <th>Bibb County</th>
      <td>22512.0</td>
      <td>22861.0</td>
    </tr>
    <tr>
      <th>Blount County</th>
      <td>57373.0</td>
      <td>57776.0</td>
    </tr>
  </tbody>
</table>
</div>



# Group by


```python
df = pd.read_csv('census.csv')
df = df[df['SUMLEV']==50]
df.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SUMLEV</th>
      <th>REGION</th>
      <th>DIVISION</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>STNAME</th>
      <th>CTYNAME</th>
      <th>CENSUS2010POP</th>
      <th>ESTIMATESBASE2010</th>
      <th>POPESTIMATE2010</th>
      <th>...</th>
      <th>RDOMESTICMIG2011</th>
      <th>RDOMESTICMIG2012</th>
      <th>RDOMESTICMIG2013</th>
      <th>RDOMESTICMIG2014</th>
      <th>RDOMESTICMIG2015</th>
      <th>RNETMIG2011</th>
      <th>RNETMIG2012</th>
      <th>RNETMIG2013</th>
      <th>RNETMIG2014</th>
      <th>RNETMIG2015</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>54571</td>
      <td>54571</td>
      <td>54660</td>
      <td>...</td>
      <td>7.242091</td>
      <td>-2.915927</td>
      <td>-3.012349</td>
      <td>2.265971</td>
      <td>-2.530799</td>
      <td>7.606016</td>
      <td>-2.626146</td>
      <td>-2.722002</td>
      <td>2.592270</td>
      <td>-2.187333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>Alabama</td>
      <td>Baldwin County</td>
      <td>182265</td>
      <td>182265</td>
      <td>183193</td>
      <td>...</td>
      <td>14.832960</td>
      <td>17.647293</td>
      <td>21.845705</td>
      <td>19.243287</td>
      <td>17.197872</td>
      <td>15.844176</td>
      <td>18.559627</td>
      <td>22.727626</td>
      <td>20.317142</td>
      <td>18.293499</td>
    </tr>
    <tr>
      <th>3</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>Alabama</td>
      <td>Barbour County</td>
      <td>27457</td>
      <td>27457</td>
      <td>27341</td>
      <td>...</td>
      <td>-4.728132</td>
      <td>-2.500690</td>
      <td>-7.056824</td>
      <td>-3.904217</td>
      <td>-10.543299</td>
      <td>-4.874741</td>
      <td>-2.758113</td>
      <td>-7.167664</td>
      <td>-3.978583</td>
      <td>-10.543299</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>7</td>
      <td>Alabama</td>
      <td>Bibb County</td>
      <td>22915</td>
      <td>22919</td>
      <td>22861</td>
      <td>...</td>
      <td>-5.527043</td>
      <td>-5.068871</td>
      <td>-6.201001</td>
      <td>-0.177537</td>
      <td>0.177258</td>
      <td>-5.088389</td>
      <td>-4.363636</td>
      <td>-5.403729</td>
      <td>0.754533</td>
      <td>1.107861</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>9</td>
      <td>Alabama</td>
      <td>Blount County</td>
      <td>57322</td>
      <td>57322</td>
      <td>57373</td>
      <td>...</td>
      <td>1.807375</td>
      <td>-1.177622</td>
      <td>-1.748766</td>
      <td>-2.062535</td>
      <td>-1.369970</td>
      <td>1.859511</td>
      <td>-0.848580</td>
      <td>-1.402476</td>
      <td>-1.577232</td>
      <td>-0.884411</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div>




```python
average_census2010pop = df.groupby('STNAME').agg({'CENSUS2010POP': np.average})
average_census2010pop.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CENSUS2010POP</th>
    </tr>
    <tr>
      <th>STNAME</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alabama</th>
      <td>71339.343284</td>
    </tr>
    <tr>
      <th>Alaska</th>
      <td>24490.724138</td>
    </tr>
    <tr>
      <th>Arizona</th>
      <td>426134.466667</td>
    </tr>
    <tr>
      <th>Arkansas</th>
      <td>38878.906667</td>
    </tr>
    <tr>
      <th>California</th>
      <td>642309.586207</td>
    </tr>
  </tbody>
</table>
</div>




```python
avg_sum_census2010pop = (df.set_index('STNAME').groupby(level=0)['CENSUS2010POP'].agg({'avg': np.average, 'sum': np.sum}))
avg_sum_census2010pop.head()
```

    C:\Users\vnfma\Anaconda3\lib\site-packages\ipykernel\__main__.py:1: FutureWarning: using a dict on a Series for aggregation
    is deprecated and will be removed in a future version
      if __name__ == '__main__':





<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>STNAME</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alabama</th>
      <td>71339.343284</td>
      <td>4779736</td>
    </tr>
    <tr>
      <th>Alaska</th>
      <td>24490.724138</td>
      <td>710231</td>
    </tr>
    <tr>
      <th>Arizona</th>
      <td>426134.466667</td>
      <td>6392017</td>
    </tr>
    <tr>
      <th>Arkansas</th>
      <td>38878.906667</td>
      <td>2915918</td>
    </tr>
    <tr>
      <th>California</th>
      <td>642309.586207</td>
      <td>37253956</td>
    </tr>
  </tbody>
</table>
</div>




```python
avg_sum_popestimate = (df.set_index('STNAME').groupby(level=0)['POPESTIMATE2010','POPESTIMATE2011'].agg({'avg': np.average, 'sum': np.sum}))
avg_sum_popestimate.head()
```





<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">avg</th>
      <th colspan="2" halign="left">sum</th>
    </tr>
    <tr>
      <th></th>
      <th>POPESTIMATE2010</th>
      <th>POPESTIMATE2011</th>
      <th>POPESTIMATE2010</th>
      <th>POPESTIMATE2011</th>
    </tr>
    <tr>
      <th>STNAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alabama</th>
      <td>71420.313433</td>
      <td>71658.328358</td>
      <td>4785161</td>
      <td>4801108</td>
    </tr>
    <tr>
      <th>Alaska</th>
      <td>24621.413793</td>
      <td>24921.379310</td>
      <td>714021</td>
      <td>722720</td>
    </tr>
    <tr>
      <th>Arizona</th>
      <td>427213.866667</td>
      <td>431248.800000</td>
      <td>6408208</td>
      <td>6468732</td>
    </tr>
    <tr>
      <th>Arkansas</th>
      <td>38965.253333</td>
      <td>39180.506667</td>
      <td>2922394</td>
      <td>2938538</td>
    </tr>
    <tr>
      <th>California</th>
      <td>643691.017241</td>
      <td>650000.586207</td>
      <td>37334079</td>
      <td>37700034</td>
    </tr>
  </tbody>
</table>
</div>



# Scales


```python
df = pd.DataFrame(['A+', 'A', 'A-', 'B+', 'B', 'B-', 'C+', 'C', 'C-', 'D+', 'D'],
                  index=['excellent', 'excellent', 'excellent', 'good', 'good', 'good', 'ok', 'ok', 'ok', 'poor', 'poor'])
df.rename(columns={0: 'Grades'}, inplace=True)
df['Grades'].head()
```




    excellent    A+
    excellent     A
    excellent    A-
    good         B+
    good          B
    Name: Grades, dtype: object




```python
df['Grades'].astype('category').head()
```




    excellent    A+
    excellent     A
    excellent    A-
    good         B+
    good          B
    Name: Grades, dtype: category
    Categories (11, object): [A, A+, A-, B, ..., C+, C-, D, D+]




```python
grades = df['Grades'].astype('category',
                             categories=['D', 'D+', 'C-', 'C', 'C+', 'B-', 'B', 'B+', 'A-', 'A', 'A+'],
                             ordered=True)
grades.head()
```

    C:\Users\vnfma\Anaconda3\lib\site-packages\ipykernel\__main__.py:3: FutureWarning: specifying 'categories' or 'ordered' in .astype() is deprecated; pass a CategoricalDtype instead
      app.launch_new_instance()





    excellent    A+
    excellent     A
    excellent    A-
    good         B+
    good          B
    Name: Grades, dtype: category
    Categories (11, object): [D < D+ < C- < C ... B+ < A- < A < A+]




```python
grades > 'C'
```




    excellent     True
    excellent     True
    excellent     True
    good          True
    good          True
    good          True
    ok            True
    ok           False
    ok           False
    poor         False
    poor         False
    Name: Grades, dtype: bool




```python
df = pd.read_csv('census.csv')
df = df[df['SUMLEV']==50]
df = df.set_index('STNAME').groupby(level=0)['CENSUS2010POP'].agg({'avg': np.average})
scaled_df = pd.cut(df['avg'],10)
scaled_df.head()
```

    C:\Users\vnfma\Anaconda3\lib\site-packages\ipykernel\__main__.py:3: FutureWarning: using a dict on a Series for aggregation
    is deprecated and will be removed in a future version
      app.launch_new_instance()





    STNAME
    Alabama         (11706.087, 75333.413]
    Alaska          (11706.087, 75333.413]
    Arizona       (390320.176, 453317.529]
    Arkansas        (11706.087, 75333.413]
    California    (579312.234, 642309.586]
    Name: avg, dtype: category
    Categories (10, interval[float64]): [(11706.087, 75333.413] < (75333.413, 138330.766] < (138330.766, 201328.118] < (201328.118, 264325.471] ... (390320.176, 453317.529] < (453317.529, 516314.881] < (516314.881, 579312.234] < (579312.234, 642309.586]]



# Pivot Tables


```python
df = pd.read_csv('cars.csv')
df.head()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>Make</th>
      <th>Model</th>
      <th>Size</th>
      <th>(kW)</th>
      <th>Unnamed: 5</th>
      <th>TYPE</th>
      <th>CITY (kWh/100 km)</th>
      <th>HWY (kWh/100 km)</th>
      <th>COMB (kWh/100 km)</th>
      <th>CITY (Le/100 km)</th>
      <th>HWY (Le/100 km)</th>
      <th>COMB (Le/100 km)</th>
      <th>(g/km)</th>
      <th>RATING</th>
      <th>(km)</th>
      <th>TIME (h)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2012</td>
      <td>MITSUBISHI</td>
      <td>i-MiEV</td>
      <td>SUBCOMPACT</td>
      <td>49</td>
      <td>A1</td>
      <td>B</td>
      <td>16.9</td>
      <td>21.4</td>
      <td>18.7</td>
      <td>1.9</td>
      <td>2.4</td>
      <td>2.1</td>
      <td>0</td>
      <td>NaN</td>
      <td>100</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012</td>
      <td>NISSAN</td>
      <td>LEAF</td>
      <td>MID-SIZE</td>
      <td>80</td>
      <td>A1</td>
      <td>B</td>
      <td>19.3</td>
      <td>23.0</td>
      <td>21.1</td>
      <td>2.2</td>
      <td>2.6</td>
      <td>2.4</td>
      <td>0</td>
      <td>NaN</td>
      <td>117</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013</td>
      <td>FORD</td>
      <td>FOCUS ELECTRIC</td>
      <td>COMPACT</td>
      <td>107</td>
      <td>A1</td>
      <td>B</td>
      <td>19.0</td>
      <td>21.1</td>
      <td>20.0</td>
      <td>2.1</td>
      <td>2.4</td>
      <td>2.2</td>
      <td>0</td>
      <td>NaN</td>
      <td>122</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013</td>
      <td>MITSUBISHI</td>
      <td>i-MiEV</td>
      <td>SUBCOMPACT</td>
      <td>49</td>
      <td>A1</td>
      <td>B</td>
      <td>16.9</td>
      <td>21.4</td>
      <td>18.7</td>
      <td>1.9</td>
      <td>2.4</td>
      <td>2.1</td>
      <td>0</td>
      <td>NaN</td>
      <td>100</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013</td>
      <td>NISSAN</td>
      <td>LEAF</td>
      <td>MID-SIZE</td>
      <td>80</td>
      <td>A1</td>
      <td>B</td>
      <td>19.3</td>
      <td>23.0</td>
      <td>21.1</td>
      <td>2.2</td>
      <td>2.6</td>
      <td>2.4</td>
      <td>0</td>
      <td>NaN</td>
      <td>117</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.pivot_table(values='(kW)', index='YEAR', columns='Make', aggfunc=np.mean)
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Make</th>
      <th>BMW</th>
      <th>CHEVROLET</th>
      <th>FORD</th>
      <th>KIA</th>
      <th>MITSUBISHI</th>
      <th>NISSAN</th>
      <th>SMART</th>
      <th>TESLA</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>280.000000</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>NaN</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>268.333333</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>320.666667</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>409.700000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.pivot_table(values='(kW)', index='YEAR', columns='Make', aggfunc=[np.mean,np.min], margins=True)
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="9" halign="left">mean</th>
      <th colspan="9" halign="left">amin</th>
    </tr>
    <tr>
      <th>Make</th>
      <th>BMW</th>
      <th>CHEVROLET</th>
      <th>FORD</th>
      <th>KIA</th>
      <th>MITSUBISHI</th>
      <th>NISSAN</th>
      <th>SMART</th>
      <th>TESLA</th>
      <th>All</th>
      <th>BMW</th>
      <th>CHEVROLET</th>
      <th>FORD</th>
      <th>KIA</th>
      <th>MITSUBISHI</th>
      <th>NISSAN</th>
      <th>SMART</th>
      <th>TESLA</th>
      <th>All</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>64.500000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>280.000000</td>
      <td>158.444444</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>270.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>NaN</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>268.333333</td>
      <td>135.000000</td>
      <td>NaN</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>225.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>320.666667</td>
      <td>181.428571</td>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>280.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>409.700000</td>
      <td>252.263158</td>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>283.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>All</th>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>345.478261</td>
      <td>190.622642</td>
      <td>125.0</td>
      <td>104.0</td>
      <td>107.0</td>
      <td>81.0</td>
      <td>49.0</td>
      <td>80.0</td>
      <td>35.0</td>
      <td>225.0</td>
      <td>35</td>
    </tr>
  </tbody>
</table>
</div>



# Date Functionality in Pandas

### Timestamp


```python
pd.Timestamp('9/1/2016 10:05AM')
```




    Timestamp('2016-09-01 10:05:00')



### Period


```python
pd.Period('1/2016')
```




    Period('2016-01', 'M')




```python
pd.Period('3/5/2016')
```




    Period('2016-03-05', 'D')



### DatetimeIndex


```python
t1 = pd.Series(list('abc'), [pd.Timestamp('2016-09-01'), pd.Timestamp('2016-09-02'), pd.Timestamp('2016-09-03')])
t1
```




    2016-09-01    a
    2016-09-02    b
    2016-09-03    c
    dtype: object




```python
type(t1.index)
```




    pandas.core.indexes.datetimes.DatetimeIndex



### PeriodIndex


```python
t2 = pd.Series(list('def'), [pd.Period('2016-09'), pd.Period('2016-10'), pd.Period('2016-11')])
t2
```




    2016-09    d
    2016-10    e
    2016-11    f
    Freq: M, dtype: object




```python
type(t2.index)
```




    pandas.core.indexes.period.PeriodIndex



### Converting to Datetime


```python
d1 = ['2 June 2013', 'Aug 29, 2014', '2015-06-26', '7/12/16']
ts3 = pd.DataFrame(np.random.randint(10, 100, (4,2)), index=d1, columns=list('ab'))
ts3
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2 June 2013</th>
      <td>94</td>
      <td>71</td>
    </tr>
    <tr>
      <th>Aug 29, 2014</th>
      <td>37</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2015-06-26</th>
      <td>76</td>
      <td>76</td>
    </tr>
    <tr>
      <th>7/12/16</th>
      <td>97</td>
      <td>33</td>
    </tr>
  </tbody>
</table>
</div>




```python
ts3.index = pd.to_datetime(ts3.index)
ts3
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-06-02</th>
      <td>94</td>
      <td>71</td>
    </tr>
    <tr>
      <th>2014-08-29</th>
      <td>37</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2015-06-26</th>
      <td>76</td>
      <td>76</td>
    </tr>
    <tr>
      <th>2016-07-12</th>
      <td>97</td>
      <td>33</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.to_datetime('4.7.12', dayfirst=True)
```




    Timestamp('2012-07-04 00:00:00')



### Timedeltas


```python
pd.Timestamp('9/3/2016')-pd.Timestamp('9/1/2016')
```




    Timedelta('2 days 00:00:00')




```python
pd.Timestamp('9/2/2016 8:10AM') + pd.Timedelta('12D 3H')
```




    Timestamp('2016-09-14 11:10:00')



### Working with Dates in a Dataframe


```python
dates = pd.date_range('10-01-2016', periods=9, freq='2W-SUN')
dates
```




    DatetimeIndex(['2016-10-02', '2016-10-16', '2016-10-30', '2016-11-13',
                   '2016-11-27', '2016-12-11', '2016-12-25', '2017-01-08',
                   '2017-01-22'],
                  dtype='datetime64[ns]', freq='2W-SUN')




```python
df = pd.DataFrame({'Count 1': 100 + np.random.randint(-5, 10, 9).cumsum(),
                  'Count 2': 120 + np.random.randint(-5, 10, 9)}, index=dates)
df
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count 1</th>
      <th>Count 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-10-02</th>
      <td>108</td>
      <td>126</td>
    </tr>
    <tr>
      <th>2016-10-16</th>
      <td>112</td>
      <td>115</td>
    </tr>
    <tr>
      <th>2016-10-30</th>
      <td>118</td>
      <td>117</td>
    </tr>
    <tr>
      <th>2016-11-13</th>
      <td>113</td>
      <td>128</td>
    </tr>
    <tr>
      <th>2016-11-27</th>
      <td>110</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2016-12-11</th>
      <td>109</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2016-12-25</th>
      <td>114</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>112</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2017-01-22</th>
      <td>114</td>
      <td>117</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.index.weekday_name
```




    Index(['Sunday', 'Sunday', 'Sunday', 'Sunday', 'Sunday', 'Sunday', 'Sunday',
           'Sunday', 'Sunday'],
          dtype='object')




```python
df.diff()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count 1</th>
      <th>Count 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-10-02</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2016-10-16</th>
      <td>4.0</td>
      <td>-11.0</td>
    </tr>
    <tr>
      <th>2016-10-30</th>
      <td>6.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2016-11-13</th>
      <td>-5.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>2016-11-27</th>
      <td>-3.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>2016-12-11</th>
      <td>-1.0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>2016-12-25</th>
      <td>5.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>-2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2017-01-22</th>
      <td>2.0</td>
      <td>-10.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.resample('M').mean()
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count 1</th>
      <th>Count 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-10-31</th>
      <td>112.666667</td>
      <td>119.333333</td>
    </tr>
    <tr>
      <th>2016-11-30</th>
      <td>111.500000</td>
      <td>127.500000</td>
    </tr>
    <tr>
      <th>2016-12-31</th>
      <td>111.500000</td>
      <td>125.000000</td>
    </tr>
    <tr>
      <th>2017-01-31</th>
      <td>113.000000</td>
      <td>122.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df['2017']
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count 1</th>
      <th>Count 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-08</th>
      <td>112</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2017-01-22</th>
      <td>114</td>
      <td>117</td>
    </tr>
  </tbody>
</table>
</div>




```python
df['2016-12']
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count 1</th>
      <th>Count 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-12-11</th>
      <td>109</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2016-12-25</th>
      <td>114</td>
      <td>125</td>
    </tr>
  </tbody>
</table>
</div>




```python
df['2016-12':]
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count 1</th>
      <th>Count 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-12-11</th>
      <td>109</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2016-12-25</th>
      <td>114</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>112</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2017-01-22</th>
      <td>114</td>
      <td>117</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.asfreq('W', method='ffill')
```




<div class="ot">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Count 1</th>
      <th>Count 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-10-02</th>
      <td>108</td>
      <td>126</td>
    </tr>
    <tr>
      <th>2016-10-09</th>
      <td>108</td>
      <td>126</td>
    </tr>
    <tr>
      <th>2016-10-16</th>
      <td>112</td>
      <td>115</td>
    </tr>
    <tr>
      <th>2016-10-23</th>
      <td>112</td>
      <td>115</td>
    </tr>
    <tr>
      <th>2016-10-30</th>
      <td>118</td>
      <td>117</td>
    </tr>
    <tr>
      <th>2016-11-06</th>
      <td>118</td>
      <td>117</td>
    </tr>
    <tr>
      <th>2016-11-13</th>
      <td>113</td>
      <td>128</td>
    </tr>
    <tr>
      <th>2016-11-20</th>
      <td>113</td>
      <td>128</td>
    </tr>
    <tr>
      <th>2016-11-27</th>
      <td>110</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2016-12-04</th>
      <td>110</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2016-12-11</th>
      <td>109</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2016-12-18</th>
      <td>109</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2016-12-25</th>
      <td>114</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2017-01-01</th>
      <td>114</td>
      <td>125</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>112</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2017-01-15</th>
      <td>112</td>
      <td>127</td>
    </tr>
    <tr>
      <th>2017-01-22</th>
      <td>114</td>
      <td>117</td>
    </tr>
  </tbody>
</table>
</div>
